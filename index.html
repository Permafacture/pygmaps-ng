<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>Google Maps - pygmaps </title>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<script type="text/javascript">
	function initialize() {

    $("input:checkbox").each(function( index ) {
      this.checked = false;
    });

		var centerlatlng = new google.maps.LatLng(30.320000, -97.770000);
		var myOptions = {
			zoom: 11,
			center: centerlatlng,
			mapTypeId: google.maps.MapTypeId.ROADMAP
		};

    var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

    function handleOptionToggle(type){
      if($("#"+type).is(':checked')){

        $.getJSON( "http://192.168.0.13:5000/?callback=?&type=" + type, function( data ) {

          $.each( data, function( shape, shapeHash ) {
            if (shape == "polygon") {
              $.each( shapeHash, function( type, typeHash ){
                window[type] = []
                $.each( typeHash["paths"], function( index, coordArray){
                  var coords = []
                  $.each( coordArray, function( index, coordSets){
                    var coordSet = []
                    $.each( coordSets, function( index, coordPair){
                      coordSet.push(new google.maps.LatLng(coordPair[0], coordPair[1]))
                    });
                    coords.push(coordSet)
                  });
                  var polygon = new google.maps.Polygon({
                    clickable: false,
                    goedesic: true,
                    strokeOpacity: 1.0,
                    strokeWeight: 1,
                    fillColor: typeHash["fillColor"],
                    fillOpacity: typeHash["fillOpacity"],
                    strokeColor: typeHash["strokeColor"],
                    paths: coords
                  });
                  polygon.setMap(map);
                  window[type].push(polygon);
                });
              });
            }
          });
        });
      }
      else{
        $.each( window[type], function(index, shape){
          shape.setMap(null);
        })
      }
    }

    $( ".map-option" ).click(function() {
      handleOptionToggle( $(this).attr('id') )
    });
  }
</script>
</head>
<body style="margin:0px; padding:0px;" onload="initialize()">
  <div id="map_interface" style="position: fixed; top: 28px; right: 28px; z-index: 500; background: #fff; padding: 14px;">
    <div>
      <input type="checkbox" id="L57" class="map-option"> L57
    </div>
  </div>
	<div id="map_canvas" style="width: 100%; height: 100%;"></div>
</body>
</html>
